<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Step 4: Stress • SWATtunR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Step 4: Stress">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SWATtunR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../articles/intro.html">Overview</a></li>
    <li><a class="dropdown-item" href="../articles/init.html">Getting Started</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Soft calibration</h6></li>
    <li><a class="dropdown-item" href="../articles/sc-phu.html">Crop PHUs</a></li>
    <li><a class="dropdown-item" href="../articles/sc-yield.html">Crop Yields</a></li>
    <li><a class="dropdown-item" href="../articles/sc-wy.html">Water Yield</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Hard calibration</h6></li>
    <li><a class="dropdown-item" href="../articles/hc-par.html">Parameter Definition</a></li>
    <li><a class="dropdown-item" href="../articles/hc-out.html">Output Definition</a></li>
    <li><a class="dropdown-item" href="../articles/hc-run.html">Performing Runs</a></li>
    <li><a class="dropdown-item" href="../articles/hc-analyze.html">Analyzing Results</a></li>
    <li><a class="dropdown-item" href="../articles/hc-val.html">Validation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Quality Assurance</h6></li>
    <li><a class="dropdown-item" href="../articles/qa.html">Preparation</a></li>
    <li><a class="dropdown-item" href="../articles/qa-st1.html">Step 1: Input</a></li>
    <li><a class="dropdown-item" href="../articles/qa-st2.html">Step 2: Management</a></li>
    <li><a class="dropdown-item" href="../articles/qa-st3.html">Step 3: Growth</a></li>
    <li><a class="dropdown-item" href="../articles/qa-st4.html">Step 4: Stress</a></li>
    <li><a class="dropdown-item" href="../articles/qa-st5.html">Step 5: Other</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/biopsichas/SWATtunR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Step 4: Stress</h1>
            <h3 data-toc-skip class="subtitle">Model simulations with
active plant stresses</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/biopsichas/SWATtunR/blob/HEAD/vignettes/qa-st4.Rmd" class="external-link"><code>vignettes/qa-st4.Rmd</code></a></small>
      <div class="d-none name"><code>qa-st4.Rmd</code></div>
    </div>

    
    
<p>When the plant growth without active stress factors is checked for
plausibility, plant growth must be analyzed when plant stresses are
active. There are two options how the effect of simulated plant stresses
can be analyzed, i) to only consider water, aeration and temperature
stress and thus to only analyze the impact of external conditions such
as weather and soil, and ii) to also include nitrogen and phosphorus
stress, and thus to also account for limitations in plant growth due to
insufficient nutrient supply.</p>
<div class="section level2">
<h2 id="qa4_step1">1. Running the SWAT+ model (with plant stress factors active)<a class="anchor" aria-label="anchor" href="#qa4_step1"></a>
</h2>
<p>Before the individual stress factors can be analyzed, we have to run
the simulations and extract the required simulation outputs. Below the
simulations are performed and saved for only external stress factors
active (excluding nutrient stress factors).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_extstress</span> <span class="op">&lt;-</span> <span class="fu">run_swat_verification</span><span class="op">(</span>project_path <span class="op">=</span> <span class="va">model_path</span>,</span>
<span>                                        outputs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'wb'</span>, <span class="st">'mgt'</span>, <span class="st">'plt'</span><span class="op">)</span>,</span>
<span>                                        years_skip <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                                        nostress <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">file_version</span> <span class="op">&lt;-</span> <span class="fu">get_file_version</span><span class="op">(</span><span class="va">parent_dir</span>, <span class="va">save_name</span>, <span class="st">'_extstr_'</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">sim_extstress</span>, file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">parent_dir</span>,<span class="st">'/'</span>, </span>
<span>                                     <span class="va">save_name</span>, <span class="st">'_extstr_'</span>, </span>
<span>                                     <span class="va">file_version</span>,<span class="st">'.rds'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">file_version</span> <span class="op">&lt;-</span> <span class="fu">get_file_version</span><span class="op">(</span><span class="va">parent_dir</span>, <span class="va">save_name</span>, <span class="st">'_extstr_'</span><span class="op">)</span></span>
<span><span class="va">sim_extstress</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">parent_dir</span>,<span class="st">'/'</span>, </span>
<span>                                       <span class="va">save_name</span>, <span class="st">'_extstr_'</span>, </span>
<span>                                       <span class="va">file_version</span>,<span class="st">'.rds'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We also run and save the simulations with all stress factors
activated, for a comparison of yield declines due to the simulated
stress factors.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_allstress</span> <span class="op">&lt;-</span> <span class="fu">run_swat_verification</span><span class="op">(</span>project_path <span class="op">=</span> <span class="va">model_path</span>,</span>
<span>                                       outputs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'wb'</span>, <span class="st">'mgt'</span>, <span class="st">'plt'</span><span class="op">)</span>,</span>
<span>                                       years_skip <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                                       nostress <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">file_version</span> <span class="op">&lt;-</span> <span class="fu">get_file_version</span><span class="op">(</span><span class="va">parent_dir</span>, <span class="va">save_name</span>, <span class="st">'_allstr_'</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">sim_allstress</span>, file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">parent_dir</span>,<span class="st">'/'</span>, </span>
<span>                                     <span class="va">save_name</span>, <span class="st">'_allstr_'</span>, </span>
<span>                                     <span class="va">file_version</span>,<span class="st">'.rds'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">file_version</span> <span class="op">&lt;-</span> <span class="fu">get_file_version</span><span class="op">(</span><span class="va">parent_dir</span>, <span class="va">save_name</span>, <span class="st">'_allstr_'</span><span class="op">)</span></span>
<span><span class="va">sim_allstress</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span>file <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">parent_dir</span>,<span class="st">'/'</span>, </span>
<span>                                       <span class="va">save_name</span>, <span class="st">'_allstr_'</span>, </span>
<span>                                       <span class="va">file_version</span>,<span class="st">'.rds'</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="qa4_step2">2. Compare yields with different stress factors activated<a class="anchor" aria-label="anchor" href="#qa4_step2"></a>
</h2>
<p>We compare the simulated yields without simulated stress factors to
the cases when only external stress factors are active and all stress
factors are active. We can expect a decline in yields due to active
stress. The decline should however be not too large. Particularly a
large number of outliers at the lower end with yields close to 0 should
raise our attention and should be further investigated. The differences
between the simulations with only external stresses and all stresses
active can be a good indicator whether the external factors or the
nutrient inputs are the more dominant factors. Please consider the
following check list:</p>
<ul>
<li><p>If you find a strong decline from <code>no_stres</code> to
<code>ext_stress</code> then the used crops should be further
investigated if their parametrizations are compatible with the climatic
inputs.</p></li>
<li><p>If aeration stress is high (will be analyzed below), soil
properties may be further investigated.</p></li>
<li><p>If water stress is high (will also be analyzed below), this may
indicate that rainfall is not sufficient and it must be further
investigated if irrigation is actually applied and has to be considered
in the management schedules.</p></li>
<li><p>Increased temperature stress can indicate that the temperature
inputs and the crop temperature parameters are not compatible. In such a
case the crop parametrization may need further attention.</p></li>
<li><p>If the decline from <code>ext_stress</code> to
<code>all_stress</code> is large then limited nutrient supply may be the
dominant factor. This can indicate insufficient fertilizer application
in the management schedules.</p></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>no_stress  <span class="op">=</span> <span class="va">sim_nostress</span>, </span>
<span>                 ext_stress <span class="op">=</span> <span class="va">sim_extstress</span>, </span>
<span>                 all_stress <span class="op">=</span> <span class="va">sim_allstress</span><span class="op">)</span></span>
<span><span class="fu">plot_variable_at_harvkill</span><span class="op">(</span><span class="va">sim_list</span>, variable <span class="op">=</span> <span class="st">'yield'</span><span class="op">)</span></span></code></pre></div>
<p><img src="figs/plot_all_yield.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="qa4_step3">3. Analyze the plant stress factors<a class="anchor" aria-label="anchor" href="#qa4_step3"></a>
</h2>
<p>Where we expected the plant stress factors to be all 0 for the
<code>sim_nostress</code> simulation runs, we will now have a look into
the simulated stresses when all stress factors are active. The plotted
results should be checked with the short check list above.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot_variable_at_harvkill</span><span class="op">(</span><span class="va">sim_allstress</span>, variable <span class="op">=</span> <span class="st">'stress'</span><span class="op">)</span></span></code></pre></div>
<p><img src="figs/plot_allstress.png" width="100%" style="display: block; margin: auto;"></p>
<p>To continue the analysis, please proceed to <a href="../articles/qa-st5.html">step 5</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Svajunas Plunge, Christoph Schuerz, Michael Strauch, Mikołaj Piniewski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
