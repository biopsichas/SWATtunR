<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Crop Yields • SWATtunR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Crop Yields">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SWATtunR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../articles/intro.html">Overview</a></li>
    <li><a class="dropdown-item" href="../articles/init.html">Getting Started</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Soft calibration</h6></li>
    <li><a class="dropdown-item" href="../articles/sc-phu.html">Crop PHUs</a></li>
    <li><a class="dropdown-item" href="../articles/sc-yield.html">Crop Yields</a></li>
    <li><a class="dropdown-item" href="../articles/sc-wy.html">Water Yield</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Hard calibration</h6></li>
    <li><a class="dropdown-item" href="../articles/hc-par.html">Parameter Definition</a></li>
    <li><a class="dropdown-item" href="../articles/hc-out.html">Output Definition</a></li>
    <li><a class="dropdown-item" href="../articles/hc-run.html">Performing Runs</a></li>
    <li><a class="dropdown-item" href="../articles/hc-analyze.html">Analyzing Results</a></li>
    <li><a class="dropdown-item" href="../articles/hc-val.html">Validation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Quality Assurance</h6></li>
    <li><a class="dropdown-item" href="../articles/qa.html">Preparation</a></li>
    <li><a class="dropdown-item" href="../articles/qa-st1.html">Step 1: Input</a></li>
    <li><a class="dropdown-item" href="../articles/qa-st2.html">Step 2: Management</a></li>
    <li><a class="dropdown-item" href="../articles/qa-st3.html">Step 3: Growth</a></li>
    <li><a class="dropdown-item" href="../articles/qa-st4.html">Step 4: Stress</a></li>
    <li><a class="dropdown-item" href="../articles/qa-st5.html">Step 5: Other</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/biopsichas/SWATtunR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Crop Yields</h1>
            <h3 data-toc-skip class="subtitle">Soft calibration workflow
for crop yields in SWAT+ models</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/biopsichas/SWATtunR/blob/HEAD/vignettes/sc-yield.Rmd" class="external-link"><code>vignettes/sc-yield.Rmd</code></a></small>
      <div class="d-none name"><code>sc-yield.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h2>
<p>This workflow focuses on adjusting crop parameters to align simulated
yields with observed data. The process is similar to the <a href="../articles/sc-phu.html">crop PHU ratio at harvest</a>
calibration, but here we fine-tune four additional parameters: leaf area
index, harvest index, base temperature for plant growth, and biomass
energy ratio.</p>
<p><img src="figs/fig4b.png" width="95%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="sccy_step1">1. Load packages, settings and yield data<a class="anchor" aria-label="anchor" href="#sccy_step1"></a>
</h2>
<p>This step is the same as in <a href="../articles/sc-phu.html#scc_step1">Crop PHU ratio at
harvest</a>.</p>
</div>
<div class="section level2">
<h2 id="sccy_step2">2. Add additional parameters<a class="anchor" aria-label="anchor" href="#sccy_step2"></a>
</h2>
<p>In addition to <code>days_mat</code>, you can also adjust other
parameters such as leaf area index (<code>lai_pot</code>), harvest index
(<code>harv_idx</code>), base temperature for plant growth
(<code>tmp_base</code>), and biomass energy ratio (<code>bm_e</code>).
These parameters can be adjusted in a similar way as
<code>days_mat</code> by creating a parameter set with the
<code><a href="../reference/sample_lhs.html">sample_lhs()</a></code> function. When making these updates, it is
important to ensure that the resulting values remain realistic and
biologically meaningful—for example, avoiding negative values or ranges
that fall outside plausible agronomic limits.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">par_bnd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="st">'lai_pot.pdb | change = relchg'</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>                  <span class="st">'harv_idx.pdb | change = relchg'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>                  <span class="st">'tmp_base.pdb | change = abschg'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>                  <span class="st">'bm_e.pdb | change = relchg'</span>     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## The number of samples can be adjusted based on the available computational resources.</span></span>
<span><span class="co">## Recommended number of samples is 50-100.</span></span>
<span><span class="va">par_crop</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_lhs.html">sample_lhs</a></span><span class="op">(</span><span class="va">par_bnd</span>, <span class="va">n_combinations</span><span class="op">)</span></span>
<span><span class="co"># Add updated days to maturity values to parameter set</span></span>
<span><span class="va">par_crop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_cols.html" class="external-link">bind_cols</a></span><span class="op">(</span><span class="va">par_crop</span>, <span class="va">dmat_sel</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sccy_step3">3. Run model for additional parameter set<a class="anchor" aria-label="anchor" href="#sccy_step3"></a>
</h2>
<p>With all parameters defined, you can now run the SWAT+ model again
using the <code>run_swatplus</code> function. This will execute the
model simulations for each combination of parameters in
<code>par_bnd</code>, and the results will be stored in the
<code>./simulation</code> folder.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run the SWAT+ model with the additional parameter set</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SWATrunR/man/run_swatplus.html" class="external-link">run_swatplus</a></span><span class="op">(</span>project_path <span class="op">=</span> <span class="va">model_path</span>,</span>
<span>             output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>yld <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SWATrunR/man/define_output.html" class="external-link">define_output</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">'mgtout'</span>,</span>
<span>                                               variable <span class="op">=</span> <span class="st">'yld'</span>,</span>
<span>                                               label <span class="op">=</span> <span class="va">crop_names</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             parameter <span class="op">=</span> <span class="va">par_crop</span>,</span>
<span>             start_date       <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># Change if necessary.</span></span>
<span>             end_date         <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># Change if necessary.</span></span>
<span>             years_skip       <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># Change if necessary.</span></span>
<span>             n_thread         <span class="op">=</span> <span class="va">n_cores</span>,</span>
<span>             save_path        <span class="op">=</span> <span class="st">'./simulation'</span>,</span>
<span>             save_file        <span class="op">=</span> <span class="fu"><a href="../reference/add_timestamp.html">add_timestamp</a></span><span class="op">(</span><span class="st">'sim_yld'</span><span class="op">)</span>,</span>
<span>             return_output    <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>             time_out         <span class="op">=</span> <span class="fl">3600</span> <span class="co"># seconds, change if run-time differs</span></span>
<span>             <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sccy_step4">4. Plot and select values for parameters<a class="anchor" aria-label="anchor" href="#sccy_step4"></a>
</h2>
<p>After running the model with the additional parameters, you can load
and visualize the results to assess the impact of the changes on crop
yields. The <code><a href="../reference/plot_dotty_yields.html">plot_dotty_yields()</a></code> function is used to plot
the crop yields for each combination of parameters, allowing you to
select the best-performing parameter set based on yield performance.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the most recent yield simulation results</span></span>
<span><span class="va">yld_sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="st">'./simulation/'</span>, pattern <span class="op">=</span> <span class="st">'[0-9]{12}_sim_yld'</span><span class="op">)</span></span>
<span><span class="va">yld_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'./simulation/'</span>, <span class="va">yld_sims</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">yld_sims</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">yld_sim</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SWATrunR/man/load_swat_run.html" class="external-link">load_swat_run</a></span><span class="op">(</span><span class="va">yld_path</span>, add_date <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># Remove days to maturity parameter columns before plotting.</span></span>
<span><span class="va">yld_sim</span><span class="op">$</span><span class="va">parameter</span><span class="op">$</span><span class="va">values</span> <span class="op">&lt;-</span> <span class="va">yld_sim</span><span class="op">$</span><span class="va">parameter</span><span class="op">$</span><span class="va">values</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span></span>
<span><span class="co">## Plot dotty figures for the selected crops</span></span>
<span><span class="fu"><a href="../reference/plot_dotty_yields.html">plot_dotty_yields</a></span><span class="op">(</span><span class="va">yld_sim</span>, <span class="va">yield_obs</span><span class="op">)</span></span></code></pre></div>
<p><img src="figs/fig8.png" width="95%" style="display: block; margin: auto;"></p>
<p>Based on this figure user can select the best performing parameter
set for each crop. The selected values are saved in
<code>crop_par_sel</code> and will be used in the final run.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fix the parameter changes you want to apply to the crops</span></span>
<span><span class="va">crop_par_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  plant_name                       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"corn"</span>, <span class="st">"cots"</span>, <span class="st">"pnut"</span><span class="op">)</span>,</span>
<span>  <span class="st">'bm_e.pdb | change = relchg'</span>     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>  <span class="op">-</span><span class="fl">0.2</span>,   <span class="op">-</span><span class="fl">0.3</span>,   <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  <span class="st">'harv_idx.pdb | change = relchg'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>  <span class="op">-</span><span class="fl">0.15</span>,  <span class="op">-</span><span class="fl">0.3</span>,   <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>  <span class="st">'lai_pot.pdb | change = relchg'</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>  <span class="op">-</span><span class="fl">0.2</span>,   <span class="op">-</span><span class="fl">0.3</span>,   <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>  <span class="st">'tmp_base.pdb | change = abschg'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>   <span class="fl">1.5</span>,    <span class="fl">1.5</span>,  <span class="op">-</span><span class="fl">1.0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check if user defined days to maturity values for all crops.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">crop_names</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">crop_par_sel</span><span class="op">$</span><span class="va">plant_name</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Restructure the set parameter changes to SWATrunR</span></span>
<span><span class="va">crop_par_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prepare_plant_parameter.html">prepare_plant_parameter</a></span><span class="op">(</span><span class="va">crop_par_sel</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sccy_step5">5. Run final simulation, evaluate results<a class="anchor" aria-label="anchor" href="#sccy_step5"></a>
</h2>
<p>In the final step, you can run the SWAT+ model with the selected
parameters using the <code>run_swatplus</code> function. This will
execute the model simulations for the final parameter set, and the
results will be stored in the <code>./simulation</code> folder.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run the simulations</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/SWATrunR/man/run_swatplus.html" class="external-link">run_swatplus</a></span><span class="op">(</span>project_path <span class="op">=</span> <span class="va">model_path</span>,</span>
<span>             output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>yld <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SWATrunR/man/define_output.html" class="external-link">define_output</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">'mgtout'</span>,</span>
<span>                                               variable <span class="op">=</span> <span class="st">'yld'</span>,</span>
<span>                                               label <span class="op">=</span> <span class="va">crop_names</span><span class="op">)</span>,</span>
<span>                           bms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SWATrunR/man/define_output.html" class="external-link">define_output</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">'mgtout'</span>,</span>
<span>                                               variable <span class="op">=</span> <span class="st">'bioms'</span>,</span>
<span>                                               label <span class="op">=</span> <span class="va">crop_names</span><span class="op">)</span>,</span>
<span>                           phu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SWATrunR/man/define_output.html" class="external-link">define_output</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">'mgtout'</span>,</span>
<span>                                               variable <span class="op">=</span> <span class="st">'phu'</span>,</span>
<span>                                               label <span class="op">=</span> <span class="va">crop_names</span><span class="op">)</span></span>
<span>             <span class="op">)</span>,</span>
<span>             parameter        <span class="op">=</span> <span class="va">par_final</span>,</span>
<span>             start_date       <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># Change if necessary.</span></span>
<span>             end_date         <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># Change if necessary.</span></span>
<span>             years_skip       <span class="op">=</span> <span class="cn">NULL</span>, <span class="co"># Change if necessary.</span></span>
<span>             n_thread         <span class="op">=</span> <span class="va">n_cores</span>,</span>
<span>             save_path        <span class="op">=</span> <span class="st">'./simulation'</span>,</span>
<span>             save_file        <span class="op">=</span> <span class="fu"><a href="../reference/add_timestamp.html">add_timestamp</a></span><span class="op">(</span><span class="st">'sim_check01'</span><span class="op">)</span>,</span>
<span>             return_output    <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>             time_out         <span class="op">=</span> <span class="fl">3600</span>, <span class="co"># seconds, change if run-time differs</span></span>
<span>             keep_folder      <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The final simulation results can be evaluated using the
<code><a href="../reference/plot_phu_yld_bms.html">plot_phu_yld_bms()</a></code> function. This plot will help assess
whether the changes made to the four parameters have significantly
affected crop yield, biomass, or PHU values. Ideally, these outputs
should remain consistent (in ranges for PHU and yields), as the main
issues related to days-to-maturity were already addressed in the first
part of the script.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the most recent check simulation results</span></span>
<span><span class="va">check_sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="st">'./simulation/'</span>, pattern <span class="op">=</span> <span class="st">'[0-9]{12}_sim_check01'</span><span class="op">)</span></span>
<span><span class="va">check_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'./simulation/'</span>, <span class="va">check_sims</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">check_sims</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">check_sim</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SWATrunR/man/load_swat_run.html" class="external-link">load_swat_run</a></span><span class="op">(</span><span class="va">check_path</span>, add_date <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot PHU, crop yields and biomass for final simulation run.</span></span>
<span><span class="fu"><a href="../reference/plot_phu_yld_bms.html">plot_phu_yld_bms</a></span><span class="op">(</span><span class="va">check_sim</span>, <span class="va">yield_obs</span>, <span class="fl">0.3</span><span class="op">)</span></span></code></pre></div>
<p><img src="figs/fig9.png" width="95%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="sccy_step6">6. Write ‘plants.plt’<a class="anchor" aria-label="anchor" href="#sccy_step6"></a>
</h2>
<p>If the final simulation results look acceptable, you can save the
adjusted parameter table to the project folder by setting
<code>overwrite = TRUE</code> in the command below. This will replace
the original <code>plants.plt</code> file. A backup of the original file
is available at <code>./backup/plants.plt</code> in case you need to
restore it.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">model_path</span>, <span class="st">'/.model_run/thread_1/plants.plt'</span><span class="op">)</span>, <span class="va">model_path</span>,</span>
<span>          overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">model_path</span>, <span class="st">'/.model_run'</span><span class="op">)</span>, recursive <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="next-steps">Next steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<p>After calibrating crop yields, you can proceed with the soft
calibration of the water yield ratio <a href="../articles/sc-wy.html">here</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Svajunas Plunge, Christoph Schuerz, Michael Strauch, Mikołaj Piniewski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
