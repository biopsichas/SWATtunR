<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SWATtunR">
<title>Plot results • SWATtunR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot results">
<meta property="og:description" content="SWATtunR">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SWATtunR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.9017</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Soft calibration</h6>
    <a class="dropdown-item" href="../articles/sc-crops.html">Crop Yields</a>
    <a class="dropdown-item" href="../articles/sc-wy.html">Water Yield</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Hard calibration</h6>
    <a class="dropdown-item" href="../articles/hc.html">Run calibration</a>
    <a class="dropdown-item" href="../articles/hc-plot.html">Plot results</a>
    <a class="dropdown-item" href="../articles/hc-plus.html">Extend calibration</a>
    <a class="dropdown-item" href="../articles/val.html">Validation</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Quality Assurance</h6>
    <a class="dropdown-item" href="../articles/qa.html">Quality Assurance</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/biopsichas/SWATtunR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot results</h1>
            <h3 data-toc-skip class="subtitle">Plot SWAT+ model
calibration results</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/biopsichas/SWATtunR/blob/HEAD/vignettes/hc-plot.Rmd" class="external-link"><code>vignettes/hc-plot.Rmd</code></a></small>
      <div class="d-none name"><code>hc-plot.Rmd</code></div>
    </div>

    
    
<p>The calibration of the SWAT+ model is a complex process that involves
many steps. One of the most important steps is the visual inspection of
the model results. This document provides an overview of the functions
available in the <code>SWATtunR</code> package for plotting SWAT+ model
calibration and validation results. Functions intended to be used for
plotting at different stages of the SWAT+ model calibration and
validation process and not in sequential order. To run these function <a href="#hc_step7">step 6</a> or/and <a href="#hc_step6a">step 6a</a>
should be completed successfully. Same packages should be loaded as in
the <a href="#hc_step1">step 1</a>.</p>
<div class="section level2">
<h2 id="hcp_step1">1. Dotty plots<a class="anchor" aria-label="anchor" href="#hcp_step1"></a>
</h2>
<p>For comparison, you can use the function <a href="../reference/plot_dotty.html">plot_dotty</a>. It allows examining
model performance results versus parameter values.</p>
<p>The function has the following arguments:</p>
<ul>
<li>
<code>par</code>: a data frame of model parameter values for each
simulation.</li>
<li>
<code>var</code>: model performance result vector or list of vectors
to be plotted against parameter values.</li>
<li>
<code>y_label</code>: the label or vector of labels for the y-axis.
Default is <code>'y'</code>.</li>
<li>
<code>n_col</code>: number of columns in the facet grid. Default is
<code>3</code>.</li>
<li>
<code>y_lim</code>: defines limits for the y-axis. Default is
<code>NULL</code>.</li>
<li>
<code>y_inter</code>: Y-axis intercept value. Default is
<code>NULL</code>.</li>
<li>
<code>trend</code>: logical, indicating whether to add a trend line.
Default is <code>FALSE</code>.</li>
<li>
<code>run_ids</code>: a numeric vector of run IDs to be highlighted
in the plot.</li>
<li>
<code>low_up</code>: logical, TRUE if the whole possible parameter
range should be used for the x-axis. Default is <code>FALSE</code>.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example of usage:</span></span>
<span><span class="fu"><a href="../reference/plot_dotty.html">plot_dotty</a></span><span class="op">(</span><span class="va">sim_flow</span><span class="op">$</span><span class="va">parameter</span><span class="op">$</span><span class="va">values</span>, <span class="va">obj_tbl</span><span class="op">$</span><span class="va">nse</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_dotty.html">plot_dotty</a></span><span class="op">(</span><span class="va">sim_flow</span><span class="op">$</span><span class="va">parameter</span><span class="op">$</span><span class="va">values</span>, <span class="va">obj_tbl</span><span class="op">$</span><span class="va">kge</span>, n_col <span class="op">=</span> <span class="fl">5</span>, y_lim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_dotty.html">plot_dotty</a></span><span class="op">(</span><span class="va">sim_flow</span><span class="op">$</span><span class="va">parameter</span><span class="op">$</span><span class="va">values</span>, <span class="va">obj_tbl</span><span class="op">$</span><span class="va">pbias</span>, n_col <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_dotty.html">plot_dotty</a></span><span class="op">(</span><span class="va">sim_flow</span><span class="op">$</span><span class="va">parameter</span><span class="op">$</span><span class="va">values</span>, <span class="va">obj_tbl</span><span class="op">$</span><span class="va">nse</span>, run_ids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">5</span><span class="op">)</span>, low_up <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_dotty.html">plot_dotty</a></span><span class="op">(</span><span class="va">sim_flow</span><span class="op">$</span><span class="va">parameter</span><span class="op">$</span><span class="va">values</span>, <span class="va">obj_tbl</span><span class="op">$</span><span class="va">kge</span>, trend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="figs/dotty.png" width="100%" style="display: block; margin: auto;"></p>
<p>Dotty plots can also be created for multiple variables in the
simulation list. In this case, the dotty plot will be displayed on the
same plot with different colors for each variable. Trends can also be
added to the plot. Water flow and water quality variables can be plotted
together on the same plot.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example of usage:</span></span>
<span><span class="fu"><a href="../reference/plot_dotty.html">plot_dotty</a></span><span class="op">(</span>par <span class="op">=</span> <span class="va">sim_flow</span><span class="op">$</span><span class="va">parameter</span><span class="op">$</span><span class="va">values</span>, </span>
<span>           var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">obj_tbl_m</span><span class="op">$</span><span class="va">obj_tbl_list</span><span class="op">$</span><span class="va">flo_day_52</span><span class="op">$</span><span class="va">nse</span>, </span>
<span>                      <span class="va">obj_tbl_m</span><span class="op">$</span><span class="va">obj_tbl_list</span><span class="op">$</span><span class="va">no3_day_52_conc</span><span class="op">$</span><span class="va">nse</span>,</span>
<span>                      <span class="va">obj_tbl_m</span><span class="op">$</span><span class="va">obj_tbl_list</span><span class="op">$</span><span class="va">gwd</span><span class="op">$</span><span class="va">nse</span><span class="op">)</span>, </span>
<span>           y_label <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Flow at 52r (m3/s)'</span>, </span>
<span>                        <span class="st">"Nitrate at 52r (mgN/l)"</span>, </span>
<span>                        <span class="st">"Groundwater depth (m)"</span><span class="op">)</span>,</span>
<span>           trend <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="figs/dotty_m.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="hcp_step2">2. Simulation vs observed values time series<a class="anchor" aria-label="anchor" href="#hcp_step2"></a>
</h2>
<p>To plot the results of selected variable sets simulation results
versus observed, you can use the <a href="../reference/plot_selected_sim.html">plot_selected_sim</a>. This
function allows you to compare the selected simulated data with the
observation data. The function has several arguments:</p>
<ul>
<li>
<code>sim</code>: object from SWATrunR.</li>
<li>
<code>obs</code>: dataframe for the observed data with two columns:
‘date’ and ‘value’.</li>
<li>
<code>par_name</code>: name of the parameter set to be used (default
is NULL, which selects the first record). If you have multiple parameter
sets, you can use this argument to select the one you want to use. For
example, <code>par_name = "flo_day"</code> or
<code>par_name = "no3_day_conc"</code>.</li>
<li>
<code>run_ids</code>: character vector with the IDs of the runs to
be used in the plot.</li>
<li>
<code>run_sel</code>: character vector with the ID or IDs of the
runs to be emphasized in the plot.</li>
<li>
<code>plot_bands</code>: logical. If TRUE, the plot will include
lower and upper bands of results.</li>
<li>
<code>period</code>: character. If NULL, the plot will be based on
the original time step of the simulation. Other examples are “day”,
“week”, “month”, “year”, etc. If “average monthly”, the plot will be
based on the multi-annual monthly values.</li>
<li>
<code>fn_summarize</code>: function to recalculate the time interval
(default is “mean”), other options include “mean”, “median”, “sum”,
“min”, “max”, etc.</li>
<li>
<code>x_label</code>: character. Label for the x-axis. Default is
“Date”.</li>
<li>
<code>y_label</code>: character. Label for the y-axis. Default is
“Discharge (m³/s)”.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##Simple example</span></span>
<span><span class="fu"><a href="../reference/plot_selected_sim.html">plot_selected_sim</a></span><span class="op">(</span><span class="va">sim_flow</span>, <span class="va">obs</span>, par_name <span class="op">=</span> <span class="st">"flo_day_52"</span>, run_ids <span class="op">=</span> <span class="va">run_sel_ids</span><span class="op">)</span></span></code></pre></div>
<p><img src="figs/sim_ts.png" width="100%" style="display: block; margin: auto;"></p>
<p>This function can also be used to plot the average monthly values of
the selected variable set. In this case, the <code>period</code>
argument should be set to “average monthly”.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Another example how all function arguments are used</span></span>
<span><span class="fu"><a href="../reference/plot_selected_sim.html">plot_selected_sim</a></span><span class="op">(</span>sim <span class="op">=</span> <span class="va">sim_flow</span>,</span>
<span>                  obs <span class="op">=</span> <span class="va">obs</span>,</span>
<span>                  par_name <span class="op">=</span> <span class="st">"flo_day_52"</span>,</span>
<span>                  run_ids <span class="op">=</span> <span class="va">run_sel_ids</span>,</span>
<span>                  run_sel <span class="op">=</span> <span class="va">run_sel_ids</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                  plot_bands <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                  period <span class="op">=</span> <span class="st">"average monthly"</span>,</span>
<span>                  fn_summarize <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>                  x_label <span class="op">=</span> <span class="st">"Month"</span>,</span>
<span>                  y_label <span class="op">=</span> <span class="st">"Monthly flow average (m&lt;sup&gt;3&lt;/sup&gt; s&lt;sup&gt;-1&lt;/sup&gt;)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="figs/ts_monthly.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="hcp_step3">3. Plotting parameter identifiability<a class="anchor" aria-label="anchor" href="#hcp_step3"></a>
</h2>
<p>The parameter identifiability plot is prepared based on the
methodology provided the article of <span class="citation">Guse et al.
(2020)</span>. The plot below shows the ranges of parameter,s which
perform better for a certain performance metric. The
<code>run_fraction</code> defines the fraction of simulations which
should be considered in the analysis (with 1000 runs this value should
maybe not be lower than <em>0.2</em>, too large values also do not make
much sense). For 5000 runs <em>0.1</em> would be a good value.</p>
<p>In case you used multiple variables in performance calculation, you
can use <code>obj_tbl_list$var_name</code> to select the variable for
which you want to plot parameter identifiability. Similar adjustment
could be done for dotty plots.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Usage example</span></span>
<span><span class="fu"><a href="../reference/plot_parameter_identifiability.html">plot_parameter_identifiability</a></span><span class="op">(</span>parameters <span class="op">=</span> <span class="va">sim_flow</span><span class="op">$</span><span class="va">parameter</span><span class="op">$</span><span class="va">values</span>,</span>
<span>                               objectives <span class="op">=</span> </span>
<span>                                 <span class="fu">select</span><span class="op">(</span><span class="va">obj_tbl</span>, <span class="op">-</span><span class="fu">starts_with</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'rank'</span>, <span class="st">'run'</span>, <span class="st">'rsr'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span>
<span>                               <span class="co">## This starts_with vector could be amended with</span></span>
<span>                               <span class="co">## other columns which should not be considered"</span></span>
<span>                               <span class="op">)</span></span></code></pre></div>
<p><img src="figs/identifiability.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="hcp_step4">4. Plotting parameter sensitivity<a class="anchor" aria-label="anchor" href="#hcp_step4"></a>
</h2>
<p>To perform an OAT (One-At-A-Time) analysis could be used to visualize
the sensitivity of the model to the parameters. The function <a href="../reference/plot_oat.html">plot_oat</a> allows you to plot the
results of the OAT analysis.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example of usage:</span></span>
<span><span class="co"># If you want to perform an OAT analysis</span></span>
<span><span class="co"># Select the parameter combination around which you want to do the OAT analysis</span></span>
<span><span class="va">par_center_id</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span></span>
<span><span class="co"># Extract the center parameter set and assign again the "full" names to be used</span></span>
<span><span class="co"># with SWATrunR</span></span>
<span><span class="va">par_center</span> <span class="op">&lt;-</span> <span class="va">sim_flow</span><span class="op">$</span><span class="va">parameter</span><span class="op">$</span><span class="va">values</span><span class="op">[</span><span class="va">par_center_id</span>, <span class="op">]</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">set_names</span><span class="op">(</span><span class="va">sim_flow</span><span class="op">$</span><span class="va">parameter</span><span class="op">$</span><span class="va">definition</span><span class="op">$</span><span class="va">full_name</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># You can define your own parameter boundaries for the selected parameters</span></span>
<span><span class="co"># Here a way how you can quickly extract the boundaries from the last simulation</span></span>
<span><span class="va">par_bnd</span> <span class="op">&lt;-</span> <span class="va">sim_flow</span><span class="op">$</span><span class="va">parameter</span><span class="op">$</span><span class="va">values</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="va">.</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">map</span><span class="op">(</span><span class="va">.</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">.x</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">bind_cols</span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">set_names</span><span class="op">(</span><span class="va">sim_flow</span><span class="op">$</span><span class="va">parameter</span><span class="op">$</span><span class="va">definition</span><span class="op">$</span><span class="va">full_name</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sample the OAT parameter set and run the simulations</span></span>
<span><span class="va">par_oat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_oat.html">sample_oat</a></span><span class="op">(</span>par <span class="op">=</span> <span class="va">par_bnd</span>, par_center <span class="op">=</span> <span class="va">par_center</span><span class="op">)</span></span>
<span></span>
<span><span class="va">par_oat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">par_oat</span>, <span class="va">parameter</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'center'</span>, <span class="st">'bf_max.aqu | change = absval'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_oat</span> <span class="op">&lt;-</span> <span class="fu">run_swatplus</span><span class="op">(</span>project_path <span class="op">=</span> <span class="va">model_path</span>,</span>
<span>                        output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                          flo_day <span class="op">=</span> <span class="fu">define_output</span><span class="op">(</span>file <span class="op">=</span> <span class="st">'channel_sd_day'</span>,</span>
<span>                                                  variable <span class="op">=</span> <span class="st">'flo_out'</span>,</span>
<span>                                                  unit <span class="op">=</span> <span class="va">cha_ids</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                        parameter <span class="op">=</span> <span class="va">par_oat</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">par_oat</span><span class="op">)</span><span class="op">]</span>,</span>
<span>                        n_thread <span class="op">=</span> <span class="va">n_cores</span><span class="op">)</span></span>
<span><span class="co"># save_file = 'sim_oat')</span></span>
<span></span>
<span><span class="co"># To visualize the OAT runs e.g. for the parameter surlag:</span></span>
<span><span class="fu"><a href="../reference/plot_oat.html">plot_oat</a></span><span class="op">(</span>sim <span class="op">=</span> <span class="va">sim_oat</span>, obs <span class="op">=</span> <span class="va">obs</span>, variable <span class="op">=</span> <span class="st">'flo_day_52'</span><span class="op">)</span></span></code></pre></div>
<p><img src="figs/oat.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="hcp_step5">5. Plotting the calibration vs validation<a class="anchor" aria-label="anchor" href="#hcp_step5"></a>
</h2>
<p>To compare the calibration and validation results, you can use the <a href="../reference/plot_calval_comparison.html">plot_calval_comparison</a>
function. This function allows you to compare the calibration and
validation results for the selected variable set. It could also be used
to compare the results of different calibration runs.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example of usage:</span></span>
<span><span class="co"># Plot results on the time series figure for validation period</span></span>
<span><span class="fu"><a href="../reference/plot_calval_comparison.html">plot_calval_comparison</a></span><span class="op">(</span><span class="va">obj_tbl_cal</span>, <span class="va">obj_tbl_val</span>, </span>
<span>                       indexes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nse"</span>, <span class="st">"kge"</span>, <span class="st">"pbias"</span>, <span class="st">"r2"</span>, <span class="st">"mae"</span> <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="figs/calval.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-guse2020" class="csl-entry">
Guse, Björn, Jens Kiesel, Matthias Pfannerstill, and Nicola Fohrer.
2020. <span>“<span class="nocase">Assessing parameter identifiability
for multiple performance criteria to constrain model
parameters</span>.”</span> <em>Hydrological Sciences Journal</em> 65
(7): 1158–72. <a href="https://doi.org/10.1080/02626667.2020.1734204" class="external-link">https://doi.org/10.1080/02626667.2020.1734204</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Svajunas Plunge, Christoph Schuerz, Michel Strauch, Mikołaj Piniewski.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
