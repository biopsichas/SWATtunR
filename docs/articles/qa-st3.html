<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Step 3: Growth • SWATtunR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Step 3: Growth">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SWATtunR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Introduction</h6></li>
    <li><a class="dropdown-item" href="../articles/intro.html">Overview</a></li>
    <li><a class="dropdown-item" href="../articles/init.html">Getting Started</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Soft calibration</h6></li>
    <li><a class="dropdown-item" href="../articles/sc-phu.html">Crop PHUs</a></li>
    <li><a class="dropdown-item" href="../articles/sc-yield.html">Crop Yields</a></li>
    <li><a class="dropdown-item" href="../articles/sc-wy.html">Water Yield</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Hard calibration</h6></li>
    <li><a class="dropdown-item" href="../articles/hc-par.html">Parameter Definition</a></li>
    <li><a class="dropdown-item" href="../articles/hc-out.html">Output Definition</a></li>
    <li><a class="dropdown-item" href="../articles/hc-run.html">Performing Runs</a></li>
    <li><a class="dropdown-item" href="../articles/hc-analyze.html">Analyzing Results</a></li>
    <li><a class="dropdown-item" href="../articles/hc-val.html">Validation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Quality Assurance</h6></li>
    <li><a class="dropdown-item" href="../articles/qa.html">Preparation</a></li>
    <li><a class="dropdown-item" href="../articles/qa-st1.html">Step 1: Input</a></li>
    <li><a class="dropdown-item" href="../articles/qa-st2.html">Step 2: Management</a></li>
    <li><a class="dropdown-item" href="../articles/qa-st3.html">Step 3: Growth</a></li>
    <li><a class="dropdown-item" href="../articles/qa-st4.html">Step 4: Stress</a></li>
    <li><a class="dropdown-item" href="../articles/qa-st5.html">Step 5: Other</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/biopsichas/SWATtunR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Step 3: Growth</h1>
            <h3 data-toc-skip class="subtitle">Analysis of unconstrained
plant growth</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/biopsichas/SWATtunR/blob/HEAD/vignettes/qa-st3.Rmd" class="external-link"><code>vignettes/qa-st3.Rmd</code></a></small>
      <div class="d-none name"><code>qa-st3.Rmd</code></div>
    </div>

    
    
<p>Examinig the unconstrained plant growth is the next step in the model
setup verification. This step is important to verify if the selected
plants and growing periods lead to plausible potential plant growth. The
following steps are important to examine.</p>
<div class="section level2">
<h2 id="qa3_step1">1. Plant stress<a class="anchor" aria-label="anchor" href="#qa3_step1"></a>
</h2>
<p>Plant growth without any simulated plant stress should result in the
potential biomass or yield a plant can gain given the climatic and soil
conditions of the simulated catchment. This step should focus on the
verification of the duration of the scheduled growing period or if the
selected crop parametrizations meet the climatic conditions. The crop
specific analyses in this step can be performed with the function
<code>plot_variable_at_harvkill</code>. First check if all plant
stresses were really deactivated in the simulations (The figure should
show all 0 values):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot_variable_at_harvkill</span><span class="op">(</span><span class="va">sim_nostress</span>, variable <span class="op">=</span> <span class="st">'stress'</span><span class="op">)</span></span></code></pre></div>
<p><img src="figs/plot_stress.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="qa3_step2">2. Potential heat unit fractions<a class="anchor" aria-label="anchor" href="#qa3_step2"></a>
</h2>
<p>A relevant indicator for the duration of the growing period is the
potential heat unit fraction. A value of 1 means that a plant reached
full maturity. Some grains should additionally dry off on the field.
Thus a value of ~1.2 should be reached. The following plot should help
you to see if the crops in the scheduled managements reach maturity.
Crops which show many values smaller than 1 must be further analyzed.
But also values much larger than 1 must be treated as implausible and
require to perform further analyses.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot_variable_at_harvkill</span><span class="op">(</span><span class="va">sim_nostress</span>, variable <span class="op">=</span> <span class="st">'phu'</span><span class="op">)</span></span></code></pre></div>
<p><img src="figs/plot_phu.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="qa3_step3">3. Unconstrained yields<a class="anchor" aria-label="anchor" href="#qa3_step3"></a>
</h2>
<p>If the potential heat unit fractions are in a plausible range the
unconstrained yields can be analyzed. The plotted values will likely be
larger than region specific literature values, but should not be much
lower than literature values. Otherwise this indicates a potential issue
with the development of the respective crop:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot_variable_at_harvkill</span><span class="op">(</span><span class="va">sim_nostress</span>, variable <span class="op">=</span> <span class="st">'yield'</span><span class="op">)</span></span></code></pre></div>
<p><img src="figs/plot_yield.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="qa3_step4">4. Further analysis of identified issues<a class="anchor" aria-label="anchor" href="#qa3_step4"></a>
</h2>
<p>If for example unusually high heat unit values, or low (almost zero)
yields are identified these must be further investigated. This can be
done by first filtering the HRUs that show the issue and then perform
some more detailed plots which may support the identification of the
issue.</p>
<p>You can filter for HRUs of interest with the function
<code>filter_hru_at_harvkill</code>. The function could be used with one
or multiple <code>crop</code>, <code>phu</code>,
<code>plant_bioms</code>, <code>yield</code>, <code>water_stress</code>,
<code>aero_stress</code>, <code>temp_stress</code>,
<code>n_stress</code> and <code>p_stress</code> variables. The example
below filters HRUs with large PHU values at harvest kill.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">high_phu</span> <span class="op">&lt;-</span> <span class="fu">filter_hru_at_harvkill</span><span class="op">(</span><span class="va">sim_nostress</span>, <span class="va">phu</span> <span class="op">&gt;</span> <span class="fl">1.86</span><span class="op">)</span></span>
<span><span class="va">high_phu</span></span></code></pre></div>
<pre><code><span><span class="co">##    hru       date crop      phu plant_bioms    yield water_stress aero_stress</span></span>
<span><span class="co">## 1 2679 2018-10-15 sgbt 1.863293    25277.69 16809.66            0           0</span></span>
<span><span class="co">## 2 6313 2018-10-15 sgbt 1.867149    25467.05 16935.59            0           0</span></span>
<span><span class="co">## 3 4602 2018-10-15 sgbt 1.862455    25388.35 16883.26            0           0</span></span>
<span><span class="co">##   temp_stress n_stress p_stress</span></span>
<span><span class="co">## 1           0        0        0</span></span>
<span><span class="co">## 2           0        0        0</span></span>
<span><span class="co">## 3           0        0        0</span></span></code></pre>
<p>If you then want to look into the crop development over time you can
do that for example with the function <code>plot_hru_pw_day</code>. In
this example high PHU values were found for sugar beets, but ofor the
HRU #2679, #4602 and #6313. Below the function plots the LAI and the bio
mass development for crops on this HRU over several years.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot_hru_pw_day</span><span class="op">(</span><span class="va">sim_nostress</span>, </span>
<span>                hru_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2679</span>, <span class="fl">4602</span>, <span class="fl">6313</span><span class="op">)</span>, </span>
<span>                var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'lai'</span>, <span class="st">'bioms'</span><span class="op">)</span>, </span>
<span>                years <span class="op">=</span> <span class="fl">2012</span><span class="op">:</span><span class="fl">2020</span>, </span>
<span>                add_crop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="figs/plot_hru_pw_day.png" width="100%" style="display: block; margin: auto;"></p>
<p>To continue the analysis, please proceed to <a href="../articles/qa-st4.html">step 4</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Svajunas Plunge, Christoph Schuerz, Michael Strauch, Mikołaj Piniewski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
