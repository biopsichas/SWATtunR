<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SWATtunR">
<title>Crop Yields • SWATtunR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Crop Yields">
<meta property="og:description" content="SWATtunR">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SWATtunR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/sc-crops.html">Crop Yields</a>
    <a class="dropdown-item" href="../articles/sc-wy.html">Water Yield</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/biopsichas/SWATtunR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Crop Yields</h1>
            <h3 data-toc-skip class="subtitle">Soft calibration workflow
for crop yields in SWAT+ models</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/biopsichas/SWATtunR/blob/HEAD/vignettes/sc-crops.Rmd" class="external-link"><code>vignettes/sc-crops.Rmd</code></a></small>
      <div class="d-none name"><code>sc-crops.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="scc_step1">1. Loading required packages<a class="anchor" aria-label="anchor" href="#scc_step1"></a>
</h2>
<p>The <code>SWATtunR</code> package is essential for soft calibration,
as it provides the necessary functions for the calibration process.
Additional packages are required for data manipulation, visualization,
SWAT+ model runs, etc.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Required libraries to run workflow</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/biopsichas/SWATtunR" class="external-link">SWATtunR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/chrisschuerz/SWATrunR" class="external-link">SWATrunR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="scc_step2">2. Defining settings<a class="anchor" aria-label="anchor" href="#scc_step2"></a>
</h2>
<p>This step requires defining the SWAT+ model path, the path to the
crop data file.</p>
<p>For the crop yield soft calibration, it’s essential to have accurate
data on observed crop yields in dry weight. The data is typically
sourced from a <code>'*.csv'</code> file, with columns specifying the
plant names and their corresponding mean yields. If additional
information is accessible, such as the minimum and maximum ranges for
average annual observed yields, it’s advisable to include them in the
<code>'*.csv'</code> file as well, under the columns labeled yield_min
and yield_max respectively. This ensures a comprehensive dataset for
effective calibration and analysis.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Path to the SWAT+ model</span></span>
<span><span class="va">model_path</span> <span class="op">&lt;-</span> <span class="st">'../test/my_dearest_model'</span></span>
<span></span>
<span><span class="co"># Path to the crop data file</span></span>
<span><span class="va">crop_data_path</span> <span class="op">&lt;-</span> <span class="st">'../inst/extdata/crop2.csv'</span></span>
<span></span>
<span><span class="co"># Set the path to save results of the soft calibration</span></span>
<span><span class="va">sc_res</span> <span class="op">&lt;-</span> <span class="st">'../test/simulations'</span></span>
<span></span>
<span><span class="co"># Set the number of cores available for calculations.  </span></span>
<span><span class="va">cores</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></code></pre></div>
<p>Crops observed yields data example is provided below.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##</span></span>
<span><span class="va">crops_obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_csv</a></span><span class="op">(</span><span class="va">crop_data_path</span>, show_col_types <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">yield_mean</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">crops_obs</span>, <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 3 × 4</span></span></span>
<span><span class="co">##   plant_name yield_min yield_max yield_mean</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> akgs            8         12         10  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> csil            7.34      13.5       11.2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> sgbt           11.0       16.9       14.0</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="scc_step3">3. Days to maturity parameter changes<a class="anchor" aria-label="anchor" href="#scc_step3"></a>
</h2>
<p>After settings following step allows to define, which days to
maturity changes will be applied in soft-calibration.</p>
<div class="section level3">
<h3 id="scc_step31">3.1. Initialization<a class="anchor" aria-label="anchor" href="#scc_step31"></a>
</h3>
<p>The preparation of this step requires the conversion of observed
yields information into numeric vectors and initialization of
<code>'plants.plt'</code> file.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Convert observed yields to numeric vectors</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"yield_mean"</span>, <span class="st">"yield_min"</span>, <span class="st">"yield_max"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">i</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">crops_obs</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/assign.html" class="external-link">assign</a></span><span class="op">(</span><span class="va">i</span>, <span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html" class="external-link">deframe</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">crops_obs</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"plant_name"</span>, <span class="va">i</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/assign.html" class="external-link">assign</a></span><span class="op">(</span><span class="va">i</span>, <span class="cn">NULL</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## Initialize unmodified backup version of plants.plt</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">model_path</span>, <span class="st">'/plants.plt.bkp0'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/copy_file_version.html">copy_file_version</a></span><span class="op">(</span><span class="va">model_path</span>, <span class="st">'plants.plt'</span>, file_version <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="scc_step32">3.2. Days to maturity changes<a class="anchor" aria-label="anchor" href="#scc_step32"></a>
</h3>
<p>The following code generates a parameter input table with changes for
required for SWAT+ model run. The names are converted into <a href="https://chrisschuerz.github.io/SWATrunR/articles/par_sampl_calib.html" class="external-link">SWATrunR
syntax</a> for the days to maturity parameter. The code snippet also
samples changes for days to maturity, allowing users to define the crops
to be used in soft calibration and the initial values for days to
maturity.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Reading the plants.plt input file from the initial unchanged backup file</span></span>
<span><span class="va">plants_plt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_tbl.html">read_tbl</a></span><span class="op">(</span>file_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">model_path</span>, <span class="st">'/plants.plt.bkp0'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">plants_plt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">plants_plt</span>, <span class="op">-</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">any_of</a></span><span class="op">(</span><span class="st">'description'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define all crops which should be calibrated</span></span>
<span><span class="co"># Alternatively define a name vector (if you also want to consider crops </span></span>
<span><span class="co"># which are not given in the observation input file).</span></span>
<span><span class="va">crops</span> <span class="op">&lt;-</span> <span class="va">crops_obs</span><span class="op">$</span><span class="va">plant_name</span></span>
<span><span class="co"># crops &lt;- c('crop1', 'crop2', 'crop3')</span></span>
<span></span>
<span><span class="co"># Get a vector with days_mat initial values for the selected crops</span></span>
<span><span class="va">dmat_init</span> <span class="op">&lt;-</span> <span class="va">plants_plt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">crops</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">days_mat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>days_mat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">days_mat</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fl">110</span>, <span class="va">days_mat</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co">## if days_mat is 0, set it to 110 (as it is the default value)</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html" class="external-link">deframe</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Sample changes for days to maturity. Depending on the number of cores you have </span></span>
<span><span class="co"># available choose a reasonable interval for the days to maturity which you want </span></span>
<span><span class="co"># to test. With an interval of 10 e.g. you have to do 12 simulations (3 rounds </span></span>
<span><span class="co"># on 4 cores), with an interval of 5 its 23 simulations.</span></span>
<span><span class="va">dmat_step</span> <span class="op">&lt;-</span> <span class="fl">20</span></span>
<span><span class="va">dmat_chg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">30</span>, <span class="fl">100</span>, <span class="va">dmat_step</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate the parameter input table with the changes for all crops and convert </span></span>
<span><span class="co"># the names into SWATrunR syntax</span></span>
<span><span class="va">par_dmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html" class="external-link">map_df</a></span><span class="op">(</span><span class="va">dmat_init</span>, <span class="op">~</span> <span class="va">.x</span> <span class="op">+</span> <span class="va">dmat_chg</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rlang.r-lib.org/reference/set_names.html" class="external-link">set_names</a></span><span class="op">(</span><span class="va">.</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'dmat_'</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span>,</span>
<span>                      <span class="st">'::days_mat.pdb | change = absval | name = '</span> , <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="scc_step4">4. Run simulations<a class="anchor" aria-label="anchor" href="#scc_step4"></a>
</h2>
<p>Days to maturity parameter changes are applied to the SWAT+ model,
and simulations are run to analyze the PHU fractions, yields and biomass
for the selected crops. <a href="https://chrisschuerz.github.io/SWATrunR/" class="external-link">SWATrunR</a> package is
used to run the simulations.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ylds_phu_dmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SWATrunR/man/run_swatplus.html" class="external-link">run_swatplus</a></span><span class="op">(</span>project_path <span class="op">=</span> <span class="va">model_path</span>,</span>
<span>                              output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>yld <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SWATrunR/man/define_output.html" class="external-link">define_output</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">'mgtout'</span>,</span>
<span>                                                                variable <span class="op">=</span> <span class="st">'yld'</span>,</span>
<span>                                                                unit <span class="op">=</span> <span class="va">crops</span><span class="op">)</span>,</span>
<span>                                            bms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SWATrunR/man/define_output.html" class="external-link">define_output</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">'mgtout'</span>,</span>
<span>                                                                variable <span class="op">=</span> <span class="st">'bioms'</span>,</span>
<span>                                                                unit <span class="op">=</span> <span class="va">crops</span><span class="op">)</span>,</span>
<span>                                            phu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SWATrunR/man/define_output.html" class="external-link">define_output</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">'mgtout'</span>,</span>
<span>                                                                variable <span class="op">=</span> <span class="st">'phu'</span>,</span>
<span>                                                                unit <span class="op">=</span> <span class="va">crops</span><span class="op">)</span></span>
<span>                              <span class="op">)</span>,</span>
<span>                              parameter <span class="op">=</span> <span class="va">par_dmat</span>,</span>
<span>                              start_date <span class="op">=</span> <span class="st">'2015-01-01'</span>,</span>
<span>                              end_date <span class="op">=</span> <span class="st">'2020-12-31'</span>,</span>
<span>                              years_skip <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                              n_thread <span class="op">=</span> <span class="va">cores</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Optionally save the simulation runs.</span></span>
<span><span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.exists</a></span><span class="op">(</span><span class="va">sc_res</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">sc_res</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">ylds_phu_dmat</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">sc_res</span>, <span class="st">"/ylds_phu_mat.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="scc_step5">5. Plot PHU fractions, yields, and biomass for days to maturity
changes<a class="anchor" aria-label="anchor" href="#scc_step5"></a>
</h2>
<p>In this figure, we visualize the PHU fractions, yields, and biomass
for various days to maturity settings. This graphical representation
serves as a reference to adjust the initial values of
<code>days_mat</code> for each crop in the simulation.</p>
<p>For grain crops, which typically dry off before harvest, aim for PHU
fractions ranging from approximately <em>1.2</em> to <em>1.5</em> to
optimize yield. Vegetables, on the other hand, tend to have a PHU
fraction around <em>1</em>, possibly slightly above, which is considered
optimal.</p>
<p>Crops like basil and broccoli are harvested before reaching full
maturity. In such cases, PHU fractions can be lower than <em>1</em>,
ranging from <em>0.5</em> to <em>0.9</em>.</p>
<p>Furthermore, it’s crucial to ensure that the simulated yields fall
within the range of locally observed yields to maintain accuracy and
relevance.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_phu_yld_bms.html">plot_phu_yld_bms</a></span><span class="op">(</span><span class="va">ylds_phu_dmat</span>, <span class="va">dmat_chg</span>, <span class="va">yield_mean</span>, <span class="va">yield_min</span>, <span class="va">yield_max</span><span class="op">)</span></span></code></pre></div>
<p><img src="figs/ylds_phu_dmat.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="scc_step6">6. Select days to maturity parameter changes to apply<a class="anchor" aria-label="anchor" href="#scc_step6"></a>
</h2>
<p>Based on the figure provided, identify the necessary adjustments to
the days to maturity parameter in the SWAT+ model. These adjustments
should be made to ensure that the PHU fractions, yields, and biomass
values of the specified crops align with the observed data.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add values based on figure to this line (please add all crops from the initial selection)</span></span>
<span><span class="co"># names(dmat_init) # Print all crop names</span></span>
<span><span class="va">chg_dmat_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>akgs <span class="op">=</span> <span class="op">-</span><span class="fl">30</span>, csil <span class="op">=</span> <span class="fl">10</span>, sgbt <span class="op">=</span>  <span class="fl">70</span>, </span>
<span>                  wbar <span class="op">=</span>   <span class="op">-</span><span class="fl">10</span>, wira <span class="op">=</span> <span class="op">-</span><span class="fl">10</span>, wiry <span class="op">=</span>  <span class="fl">0</span>, wwht <span class="op">=</span>  <span class="op">-</span><span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Adding defined changes to initial days_mat values of crops</span></span>
<span><span class="va">dmat_sel</span> <span class="op">&lt;-</span> <span class="va">chg_dmat_sel</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dmat_init</span><span class="op">)</span><span class="op">]</span> <span class="op">+</span> <span class="va">dmat_init</span></span>
<span><span class="va">dmat_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/enframe.html" class="external-link">enframe</a></span><span class="op">(</span><span class="va">dmat_sel</span>, value <span class="op">=</span> <span class="st">'days_mat_upd'</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="scc_step7">7. Write d_mat modifications into file<a class="anchor" aria-label="anchor" href="#scc_step7"></a>
</h2>
<p>Write the changes to the <code>plants.plt</code> file to update the
days to maturity values for the selected crops and also backup the
updated file to <code>plants.plt.bkp1</code> file.</p>
<pre><code><span><span class="co">## [1] TRUE</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="scc_step8">8. Check initial crop lai_pot, harv_idx, tmp_base, bm_e
parameters<a class="anchor" aria-label="anchor" href="#scc_step8"></a>
</h2>
<p>After fixing the days to maturity values, it might be needed to
address values of the <code>lai_pot</code>, <code>harv_idx</code>,
<code>tmp_base</code>, and <code>bm_e</code> parameters for the selected
crops. These parameters are crucial for the simulation and should be
adjusted if PHU fractions, yields, and biomass values are not within the
expected range.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plants_plt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_tbl.html">read_tbl</a></span><span class="op">(</span>file_path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">model_path</span>, <span class="st">'/plants.plt'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">par_ini</span> <span class="op">&lt;-</span> <span class="va">plants_plt</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">crops</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">lai_pot</span>, <span class="va">harv_idx</span>, <span class="va">tmp_base</span>, <span class="va">bm_e</span><span class="op">)</span><span class="co">#, days_mat)</span></span>
<span><span class="va">par_ini</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 7 × 5</span></span></span>
<span><span class="co">##   name  lai_pot harv_idx tmp_base  bm_e</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> csil      4       0.9         8  39  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> sgbt      5       2           4  30  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> wbar      4       0.54        0  30  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> wwht      4       0.4         0  30  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> wira      3.5     0.23        5  38  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> wiry      4       0.4         0  30  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">7</span> akgs      4       0.75        0  12.5</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="scc_step9">9. Create sample of lai_pot, harv_idx, tmp_base, bm_e parameters
with LHS<a class="anchor" aria-label="anchor" href="#scc_step9"></a>
</h2>
<p>For this we will use the <a href="../reference/sample_lhs.html">sample_lhs</a> function to create a
sample of parameter values for the selected crops. The sample will be
used to run SWAT+ simulations and evaluate the impact of the parameter
changes on the model output. The syntax for the parameter boundaries
could be found on the <a href="https://chrisschuerz.github.io/SWATrunR/articles/SWATrunR.html#parameter-inputs" class="external-link">SWATrunR
page</a>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Define changes to be applied to the initial parameter values</span></span>
<span><span class="co">## Make sure your updates will not produce unrealistic values (i.e. negative values)!!!</span></span>
<span><span class="va">par_bnd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="st">'lai_pot.pdb | change = relchg'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>                  <span class="st">'harv_idx.pdb | change = relchg'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>                  <span class="st">'tmp_base.pdb | change = relchg'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>                  <span class="co"># 'tmp_base.pdb | change = abschg' = c(-2, 2),</span></span>
<span>                  <span class="st">'bm_e.pdb | change = relchg'</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">par_crop</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sample_lhs.html">sample_lhs</a></span><span class="op">(</span><span class="va">par_bnd</span>, <span class="fl">10</span><span class="op">)</span> <span class="co">## 10 samples for each parameter will be generated. </span></span>
<span><span class="co">## The number of samples can be adjusted based on the available computational resources.</span></span>
<span><span class="co">## Recommended number of samples is 50-100.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="scc_step10">10. Run SWATrunR for prepared parameter set<a class="anchor" aria-label="anchor" href="#scc_step10"></a>
</h2>
<p>Run the SWAT+ model with the updated parameters for the selected
crops should be rerun. The simulation results will be used to evaluate
the impact of the parameter changes on the model output.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ylds_plnt_par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SWATrunR/man/run_swatplus.html" class="external-link">run_swatplus</a></span><span class="op">(</span>project_path <span class="op">=</span> <span class="va">model_path</span>,</span>
<span>                              output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>yld <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SWATrunR/man/define_output.html" class="external-link">define_output</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">'mgtout'</span>,</span>
<span>                                                                variable <span class="op">=</span> <span class="st">'yld'</span>,</span>
<span>                                                                unit <span class="op">=</span> <span class="va">crops</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                              parameter <span class="op">=</span> <span class="va">par_crop</span>,</span>
<span>                              n_thread <span class="op">=</span> <span class="va">cores</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Save the results to the file</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">ylds_plnt_par</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">sc_res</span>, <span class="st">"/ylds_plnt_par.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="scc_step11">11. Examine results in figures<a class="anchor" aria-label="anchor" href="#scc_step11"></a>
</h2>
<p>Plotting simulation results in dotty plots can help to identify
parameter sensitivities and how to modify them. After examining the
patterns in dotty plots, you may consider adjusting certain parameter
ranges (<a href="#scc_step9">step 9</a>) and then rerunning the model
(<a href="#scc_step10">step 10</a>) to observe any changes in the
results. Subsequently, you can reanalyze the outcomes with <a href="../reference/plot_dotty_yields.html">plot_dotty_yields</a>
function to gain further insights or refine your understanding of the
system being modeled.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot dotty figures for the selected crops</span></span>
<span><span class="fu"><a href="../reference/plot_dotty_yields.html">plot_dotty_yields</a></span><span class="op">(</span><span class="va">ylds_plnt_par</span>, <span class="va">yield_mean</span>, <span class="va">yield_min</span>, <span class="va">yield_max</span><span class="op">)</span></span></code></pre></div>
<p><img src="figs/ylds_plnt_par.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="scc_step12">12. Update parameter values in plants.plt file<a class="anchor" aria-label="anchor" href="#scc_step12"></a>
</h2>
<p>After examining the results of the SWAT+ simulations, you can adjust
the parameter values in the <code>plants.plt</code> file. Not all
parameters need to be changed, but only those that are sensitive might
help to improve the model performance. Different crops exhibit different
sensitivities to the parameters, so it is important to select parameters
for each crop. Following code sniplet shows how to update the
<code>plants.plt</code> file.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Fix changes you want to write in plants.plt file</span></span>
<span><span class="va">chg_par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  name     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"akgs"</span>,<span class="st">"barl"</span>, <span class="st">"csil"</span>, <span class="st">"sgbt"</span>, <span class="st">"wbar"</span>, <span class="st">"wira"</span>, <span class="st">"wiry"</span>, <span class="st">"wwht"</span><span class="op">)</span>,</span>
<span>  lai_pot  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>    <span class="fl">0</span>,     <span class="fl">0</span>,      <span class="fl">0</span>,      <span class="fl">0</span>,      <span class="fl">0</span>,      <span class="fl">0</span>,      <span class="fl">0</span>,      <span class="fl">0</span><span class="op">)</span>,</span>
<span>  harv_idx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>    <span class="fl">0</span>,     <span class="fl">0</span>,      <span class="fl">0</span>,      <span class="fl">0</span>,      <span class="fl">0</span>,      <span class="fl">0</span>,    <span class="fl">0.3</span>,    <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>  tmp_base <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>    <span class="fl">0</span>,     <span class="fl">0</span>,      <span class="fl">0</span>,      <span class="fl">0</span>,      <span class="fl">0</span>,      <span class="fl">0</span>,   <span class="op">-</span><span class="fl">0.2</span>,   <span class="op">-</span><span class="fl">0.2</span><span class="op">)</span>,</span>
<span>  bm_e     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>    <span class="fl">0</span>,     <span class="fl">0</span>,      <span class="fl">0</span>,      <span class="fl">0</span>,      <span class="fl">0</span>,      <span class="fl">0</span>,      <span class="fl">0</span>,      <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">plants_plt</span>, <span class="va">name</span><span class="op">)</span>, <span class="va">.</span>, by <span class="op">=</span> <span class="st">'name'</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Update parameter values in plants.plt</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">par_bnd</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">par_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">chg_par</span><span class="op">)</span><span class="op">[</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="va">chg_typ_i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">".*change = "</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">par_bnd</span><span class="op">)</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="va">plants_plt</span><span class="op">[</span><span class="va">par_i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/update_par.html">update_par</a></span><span class="op">(</span><span class="va">plants_plt</span><span class="op">[[</span><span class="va">par_i</span><span class="op">]</span><span class="op">]</span>, <span class="va">chg_par</span><span class="op">[[</span><span class="va">par_i</span><span class="op">]</span><span class="op">]</span>, <span class="va">chg_typ_i</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## Overwriting plants.plt with the updated parameter values.</span></span>
<span><span class="fu"><a href="../reference/write_tbl.html">write_tbl</a></span><span class="op">(</span><span class="va">plants_plt</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">model_path</span>, <span class="st">'/plants.plt'</span><span class="op">)</span>, fmt <span class="op">=</span> <span class="va">plants_plt_fmt</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="scc_step13">13. Rerun final plants.plt parameter selection<a class="anchor" aria-label="anchor" href="#scc_step13"></a>
</h2>
<p>After updating the <code>plants.plt</code> file with the new
parameter values, you can rerun the SWAT+ model to evaluate the impact
of the parameter changes on the model output. The simulation results
should provide you model, which is soft calibrated for the selected
crops.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phu_yld_final</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SWATrunR/man/run_swatplus.html" class="external-link">run_swatplus</a></span><span class="op">(</span>project_path <span class="op">=</span> <span class="va">model_path</span>,</span>
<span>                              output <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>yld <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SWATrunR/man/define_output.html" class="external-link">define_output</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">'mgtout'</span>,</span>
<span>                                                                variable <span class="op">=</span> <span class="st">'yld'</span>,</span>
<span>                                                                unit <span class="op">=</span> <span class="va">crops</span><span class="op">)</span>,</span>
<span>                                            bms <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SWATrunR/man/define_output.html" class="external-link">define_output</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">'mgtout'</span>,</span>
<span>                                                                variable <span class="op">=</span> <span class="st">'bioms'</span>,</span>
<span>                                                                unit <span class="op">=</span> <span class="va">crops</span><span class="op">)</span>,</span>
<span>                                            phu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/SWATrunR/man/define_output.html" class="external-link">define_output</a></span><span class="op">(</span>file <span class="op">=</span> <span class="st">'mgtout'</span>,</span>
<span>                                                                variable <span class="op">=</span> <span class="st">'phu'</span>,</span>
<span>                                                                unit <span class="op">=</span> <span class="va">crops</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Save the results to the file</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">phu_yld_final</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">sc_res</span>, <span class="st">"/phu_yld_final.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<ol start="14" style="list-style-type: decimal">
<li>Examine the final results {#scc_step14}</li>
</ol>
<p>Egamine the final results of the SWAT+ simulations. The simulation
results should provide you model, which is soft calibrated for the
selected crops.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_phu_yld_bms.html">plot_phu_yld_bms</a></span><span class="op">(</span><span class="va">phu_yld_final</span>, <span class="fl">0</span>, <span class="va">yield_mean</span>, <span class="va">yield_min</span>, <span class="va">yield_max</span><span class="op">)</span></span></code></pre></div>
<p><img src="figs/phu_yld_final.png" width="100%" style="display: block; margin: auto;">
For a more in-depth analysis, users can employ additional <a href="https://git.ufz.de/schuerz/swatdoctr" class="external-link">SWATdoctR functions</a>,
like <code>plot_hru_pw_day()</code>. This function enables visualization
of daily time series of variables from the output file
<code>hru_pw_day.txt</code> related to hydrological response units ,
providing valuable insights into the model’s performance and behavior.
This might help understanding of the model’s outputs and decide if crop
yield soft calibration results are acceptable.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Svajunas Plunge, Christoph Schuerz, Michel Strauch, Mikołaj Piniewski.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
