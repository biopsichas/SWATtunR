<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="SWATtunR">
<title>Validation • SWATtunR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Validation">
<meta property="og:description" content="SWATtunR">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">SWATtunR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.9016</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Soft calibration</h6>
    <a class="dropdown-item" href="../articles/sc-crops.html">Crop Yields</a>
    <a class="dropdown-item" href="../articles/sc-wy.html">Water Yield</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Hard calibration</h6>
    <a class="dropdown-item" href="../articles/hc.html">Run calibration</a>
    <a class="dropdown-item" href="../articles/hc-plot.html">Plot results</a>
    <a class="dropdown-item" href="../articles/hc-plus.html">Extend calibration</a>
    <a class="dropdown-item" href="../articles/val.html">Validation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/biopsichas/SWATtunR/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Validation</h1>
            <h3 data-toc-skip class="subtitle">Workflow to validate
calibrated models</h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/biopsichas/SWATtunR/blob/HEAD/vignettes/val.Rmd" class="external-link"><code>vignettes/val.Rmd</code></a></small>
      <div class="d-none name"><code>val.Rmd</code></div>
    </div>

    
    
<p>After the calibration process, the SWAT+ model should be validated to
ensure that the model is not overfitted. The validation process is
similar to the calibration process, but the validation data set is used
instead of the calibration data set. The following lines provide an
example of how to validate the SWAT+ model. It is important to mention,
that model run during the final calibration step should cover both
calibration and validation periods.</p>
<div class="section level2">
<h2 id="val_step1">1. Validation preparation<a class="anchor" aria-label="anchor" href="#val_step1"></a>
</h2>
<p>To prepare validation data set is quite simple with <a href="../reference/fix_dates.html">fix_dates</a> function, which cuts
simulation results and observations to defined validation period.
Following code snippet shows how to prepare validation data set.
<code>wq_val_period</code> was defined select_best_print. Example could
bewritten as
<code>wq_val_period &lt;- c("2010-01-01", "2014-12-31")</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Readjusting the dates of the simulated and observed data for validation period</span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fix_dates.html">fix_dates</a></span><span class="op">(</span><span class="va">sim_wq_full</span>, <span class="va">obs_wq_full</span>, trim_start <span class="op">=</span> <span class="va">wq_val_period</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>                 trim_end <span class="op">=</span> <span class="va">wq_val_period</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">sim_wq_val</span> <span class="op">&lt;-</span> <span class="va">tmp</span><span class="op">$</span><span class="va">sim</span></span>
<span><span class="va">obs_wq_val</span> <span class="op">&lt;-</span> <span class="va">tmp</span><span class="op">$</span><span class="va">obs</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="val_step2">2. Performance calculation<a class="anchor" aria-label="anchor" href="#val_step2"></a>
</h2>
<p>To calculate the performance of the SWAT+ model, you can use the same
functions as in the calibration process. The following code snippet
shows how to calculate the performance of the SWAT+ model for the
validation period. <code>obj_tbl_cal</code> dataframe is obtained at the
end of calibration and contains the best run ids
@ref(select_best_print).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate the performance metrics for validation period</span></span>
<span><span class="va">obj_tbl_val</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_performance.html">calculate_performance</a></span><span class="op">(</span><span class="va">sim_wq_val</span>, <span class="va">obs_wq_val</span>, par_name <span class="op">=</span> <span class="st">"flo_day_52"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Filter the performance metrics for the selected calibration runs</span></span>
<span><span class="va">obj_tbl_val</span> <span class="op">&lt;-</span> <span class="va">obj_tbl_val</span><span class="op">[</span><span class="va">obj_tbl_val</span><span class="op">$</span><span class="va">run_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">obj_tbl_cal</span><span class="op">$</span><span class="va">run_id</span>,<span class="op">]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="val_step3">3. Performance visualization<a class="anchor" aria-label="anchor" href="#val_step3"></a>
</h2>
<p>To visualize the performance of the SWAT+ model, you can use the same
functions as in the calibration process. Particularly, the <a href="../reference/plot_calval_comparison.html">plot_calval_comparison</a>
and <a href="../reference/plot_selected_sim.html">plot_selected_sim</a>
functions could be used to visualize the performance of the SWAT+ model
for validation period.</p>
</div>
<div class="section level2">
<h2 id="val_step4">4. Write out <em>‘calibration.cal’</em> file<a class="anchor" aria-label="anchor" href="#val_step4"></a>
</h2>
<p>The final step is to write out the “calibration.cal” file, which
could be supplied to the model to run already calibrated and validated
model. Please don’t forget to check master file <a href="https://swatplus.gitbook.io/io-docs/introduction/master-file-file.cio" class="external-link"><em>‘file.cio’</em></a>,
if it has connection to <em>‘calibration.cal’</em> on line 22. The
following code snippet shows how to write out the
<em>‘calibration.cal’</em> file.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">write_cal_file</span>(<span class="at">par =</span> par_flow, </span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>               <span class="at">write_path =</span> <span class="st">'your_path'</span>,</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>               <span class="at">i_run =</span> <span class="dv">1</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="st">``</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Svajunas Plunge, Christoph Schuerz, Michel Strauch, Mikołaj Piniewski.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
